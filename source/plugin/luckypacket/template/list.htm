<div id="ct" class="wp cl">
	<div class="bm">
		<!--{if !$pId}-->
		<div class="tb tb_h cl">
			<ul>
			<!--{if $selfPacket}--><li class="y o"><a href="plugin.php?id=luckypacket&module=admin&op=add&pspecial=3">{lang luckypacket:packet_add_3}</a></li><!--{/if}-->
			<li {if $_GET['module'] != 'showlog'}class="a"{/if}><a href="plugin.php?id=luckypacket">{lang luckypacket:packetlist}</a></li>
			<li {if $_GET['module'] == 'showlog'}class="a"{/if}><a href="plugin.php?id=luckypacket&module=showlog">{lang luckypacket:my_record}</a></li>
			</ul>
		</div>
		<!--{/if}-->
		<div class="bm_c">
			<div class="xld xlda cl">
		<!--{if $_GET['module'] == 'showlog'}-->
			<div class="tbmu cl">
				<div class="y"></div>
				<div class="box" style="padding: 5px">
					<!--{if $op != 'all'}--><a class="a">{lang luckypacket:my_get_record}</a><!--{if $packetAdmin}--><span class="pipe">|</span><a href="plugin.php?id=luckypacket&module=showlog&op=all">{lang luckypacket:all_get_record}</a><!--{/if}--><!--{else}--><a href="plugin.php?id=luckypacket&module=showlog">{lang luckypacket:my_get_record}</a><!--{if $packetAdmin}--><span class="pipe">|</span><a class="a">{lang luckypacket:all_get_record}</a><!--{/if}--><!--{/if}--><span class="pipe">|</span>
					<a id="filter_dateline" href="javascript:;" onmouseover="showMenu(this.id)">
						<!--{if $dateline == 86400}-->{lang luckypacket:last_1_days}<!--{elseif $dateline == 172800}-->{lang luckypacket:last_2_days}<!--{elseif $dateline == 604800}-->{lang luckypacket:list_one_week}<!--{elseif $dateline == 2592000}-->{lang luckypacket:list_one_month}<!--{elseif $dateline == 7948800}-->{lang luckypacket:list_three_month}<!--{else}-->{lang luckypacket:search_any_date}<!--{/if}-->
					</a>
				</div>
				<div id="filter_dateline_menu" class="p_pop" style="display:none">
					<ul class="th">
						<li><a href="plugin.php?id=luckypacket&module=showlog<!--{if $op == 'all'}-->&op=all<!--{/if}-->">{lang luckypacket:search_any_date}</a></li>
						<li><a href="plugin.php?id=luckypacket&module=showlog<!--{if $op == 'all'}-->&op=all<!--{/if}-->&fdateline=86400">{lang luckypacket:last_1_days}</a></li>
						<li><a href="plugin.php?id=luckypacket&module=showlog<!--{if $op == 'all'}-->&op=all<!--{/if}-->&fdateline=172800">{lang luckypacket:last_2_days}</a></li>
						<li><a href="plugin.php?id=luckypacket&module=showlog<!--{if $op == 'all'}-->&op=all<!--{/if}-->&fdateline=604800">{lang luckypacket:list_one_week}</a></li>
						<li><a href="plugin.php?id=luckypacket&module=showlog<!--{if $op == 'all'}-->&op=all<!--{/if}-->&fdateline=2592000">{lang luckypacket:list_one_month}</a></li>
						<li><a href="plugin.php?id=luckypacket&module=showlog<!--{if $op == 'all'}-->&op=all<!--{/if}-->&fdateline=7948800">{lang luckypacket:list_three_month}</a></li>
					</ul>
				</div>
			</div>
			<div class="tl">
				<table cellspacing="0" cellpadding="3" border="0" width="100%">
				<!--{if $myLogs}-->
				<tr>
					<td><span class="xi1">{lang luckypacket:username}</span></td>
					<td><span class="xi1">{lang luckypacket:get_packetid}</span></td>
					<td><span class="xi1">{lang luckypacket:get_issuetype}</span></td>
					<td><span class="xi1">{lang luckypacket:get_credit_name}</span></td>
					<td><span class="xi1">{lang luckypacket:get_credit_num}</span></td>
					<td><span class="xi1">{lang luckypacket:get_credit_dateline}</span></td>
					<td width="120"><span class="xi1">{lang luckypacket:get_credit_ip}</span></td>
				</tr>
				<!--{loop $myLogs $log}-->
				<tr>
					<td>$log['username']</td>
					<td><a href="plugin.php?id=luckypacket&pid={$log['packetid']}">$log['packetid']</a></td>
					<td><!--{if $log['issuetype']==1}-->{lang luckypacket:add_packet_fix}<!--{else}-->{lang luckypacket:add_packet_rand}<!--{/if}--></td>
					<td>$_G['setting']['extcredits'][$log['extcredit']]['title']</td>
					<td>$log['creditnum']</td>
					<td><!--{date($log['dateline'], 'Y-n-j H:i:s')}--></td>
					<td width="120">$log['opip']</td>
				</tr>
				<!--{/loop}-->
				<!--{if $multipage}--><tr><td colspan="7">$multipage</td></tr><!--{/if}-->
				<!--{else}-->
				<tr><td>
				<br /><br /><center>{lang luckypacket:no_log}</center><br /><br /><br />
				</td></tr>
				<!--{/if}-->
				</table>
			</div>
		<!--{else}-->
			<!------------------!!!!----------------------------------------->
			<div class="mainbox">
				<table cellspacing="0" cellpadding="0" width="100%">
				<!--{if $stars}-->
				<tr><td>{lang luckypacket:stars_of_forum}</td></tr>
				<tr><td>
					<span style="font-weight: bold;">{lang luckypacket:stars_of_forum}</span>
				</td></tr>
				<!--{/if}-->
				</table>
			</div>
			<div class="tbmu cl">
				<div class="box" style="padding: 5px">
					<a{if $op == 'list'} class="a"{/if} href="plugin.php?id=luckypacket">{lang luckypacket:packet_all}</a><span class="pipe">|</span><a{if $op == 'nor'} class="a"{/if} href="plugin.php?id=luckypacket&op=nor">{lang luckypacket:packet_0}</a><span class="pipe">|</span><a{if $op == 'daily'} class="a"{/if} href="plugin.php?id=luckypacket&op=daily">{lang luckypacket:packet_1}</a><span class="pipe">|</span><a{if $op == 'reply'} class="a"{/if} href="plugin.php?id=luckypacket&op=reply">{lang luckypacket:packet_2}</a><span class="pipe">|</span><a{if $op == 'diy'} class="a"{/if} href="plugin.php?id=luckypacket&op=diy">{lang luckypacket:packet_3}</a><span class="pipe">|</span><a{if $op == 'self'} class="a"{/if} href="plugin.php?id=luckypacket&op=self">{lang luckypacket:mypacketlist}</a>
				</div>
			</div>
			<table cellpadding="0" cellspacing="0" border="0" width="100%">
			<!--{if empty($packetList)}-->
				<tr><td align="center" colspan="3">{lang luckypacket:no_packet}</td></tr>
			<!--{else}-->
				<form action="plugin.php?id=luckypacket&module=ajax&action=get&getsubmit=yes" autocomplete="off" method="post">
				<input type="hidden" value="" name="packetid">
				<!--{loop $packetList $packetdata}-->
				<tr class="bbda" id="trbg$packetdata['packetid']"{if $packetdata['status']!=PACKEY_STATUS_OPEN || ($packetdata['starttimeto'] != 0 && $packetdata['starttimeto']<TIMESTAMP) || $packetdata['ispass'] != 1} style="background: #ffa"{/if}>
					<th class="icn bbda" style="width:80px;">
						<a onclick="showWindow('log', this.href);return false;" href="plugin.php?id=luckypacket&module=glog&pid=$packetdata['packetid']" title="$packetdata['pname'] {lang luckypacket:draw_already}"><img src="source/plugin/luckypacket/image/{if $packetdata[pspecial] == PACKET_TYPE_DAILY}dp.gif{elseif $packetdata[pspecial] == PACKET_TYPE_PERSON}pp.gif{else}op.gif{/if}" alt="$packetdata['pname'] {lang luckypacket:draw_already}" /></a>
					</th>
					<td class="emp bbda plist">
						<ul>
							<li><em class="xw1">{lang luckypacket:add_packet_name}</em><!--{if $packetdata['pspecial'] == PACKET_TYPE_PERSON}-->[<a href="home.php?mod=space&uid=$packetdata['originatorid']" target="_blank">$packetdata['username']</a>]<!--{elseif $packetdata['pspecial'] == PACKET_TYPE_DAILY}-->[{lang luckypacket:packet_1}]<!--{elseif $packetdata['pspecial'] == PACKET_TYPE_REPLY}-->[{lang luckypacket:packet_2}]<!--{/if}--><span class="xi1">$packetdata['pname']</span><!--{if $packetdata['ispass'] != 1}--><span id="no_pass$packetdata['packetid']">[{lang luckypacket:personal_moderate}]&nbsp;</span><!--{/if}--></li>
							<li><em class="xw1">{lang luckypacket:add_packet_note}</em><span>$packetdata['description']</span></li>
							<li><em class="xw1">{lang luckypacket:get_credit_num_1}</em><span><!--{if $packetdata['issuetype'] == 2}-->$packetdata['packetminnum'] ~ $packetdata['packetmaxnum']<!--{else}-->$packetdata['certainnum']<!--{/if}-->&nbsp;$packetdata['issuecredit']</span></li>
							<!--{if $packetdata['rtid']}--><li><em class="xw1">{lang luckypacket:add_packet_rtid}</em><span>[<a href="forum.php?mod=viewthread&tid={$packetdata['rtid']}" target="_blank">{lang luckypacket:click_to_view}</a>]</span></li><!--{/if}-->
							<li><em class="xw1">{lang luckypacket:add_packet_num_pp}</em><span>$packetdata['num_pp']</span></li>
							<li><em class="xw1">{lang luckypacket:add_packet_modnum_multiply}</em><span>$packetdata['modnum_multiply'] {lang luckypacket:multiple}</span></li>
							<li><em class="xw1">{lang luckypacket:remain_num}</em><span><!--{if $packetdata['total_num'] == -1}-->{lang luckypacket:unlimited}<!--{else}-->$packetdata['remainNum'] / $packetdata['total_num']<!--{/if}--></span></li>
							<li><em class="xw1">{lang luckypacket:total_draw}</em><span>$packetdata['tnum']</span></li>
							<li><em class="xw1">{lang luckypacket:add_packet_gender_restricted}</em><span><!--{if $packetdata['gender'] == 1}-->{lang luckypacket:add_packet_gender_male}<!--{elseif $packetdata['gender'] == 2}-->{lang luckypacket:add_packet_gender_female}<!--{else}-->{lang luckypacket:add_packet_gender_both}<!--{/if}--></span></li>
							<li><em class="xw1">{lang luckypacket:add_packet_reg_day_restricted}</em><span>$packetdata['reg_day'] {lang luckypacket:day}</span></li>
							<li><em class="xw1">{lang luckypacket:add_packet_postnum_restricted}</em><span>$packetdata['postnum'] {lang luckypacket:thread}</span></li>
							<li><em class="xw1">{lang luckypacket:add_packet_credit_restricted}</em><span>$packetdata['credit']</span></li>
							<li><em class="xw1">{lang luckypacket:add_packet_usergroup_restricted}</em><span>$packetdata['allowedGroup']</span></li>
							<li><em class="xw1">{lang luckypacket:add_packet_timelimit}</em><span><!--{if !$packetdata['starttimefrom'] && !$packetdata['starttimeto']}-->{lang luckypacket:unlimited}<!--{else}--><!--{if $packetdata['starttimefrom']}--><!--{date($packetdata['starttimefrom'], 'Y-n-j H:i:s')}--><!--{else}-->-<!--{/if}--> ~ <!--{if $packetdata['starttimeto']}--><!--{date($packetdata['starttimeto'], 'Y-n-j H:i:s')}--><!--{else}-->-<!--{/if}--><!--{/if}--></span></li>
						</ul>
					</td>
					<td class="bbda" style="width:120px;" align="center">
						<p class="mbn"><button style="clear:both;" onclick="this.form.packetid.value = '$packetdata[packetid]';this.form.submit();return false;" class="pn" type="button"><strong>{lang luckypacket:get_packet}</strong></button></p>
						<!--{if $_G['uid'] && ($packetAdmin || $packetdata['pspecial'] == PACKET_TYPE_PERSON && ($_G['uid'] == $packetdata['originatorid']))}-->
						<p class="mbn"><button style="clear:both;" class="pn" type="button" onclick="javascript:window.location='plugin.php?id=luckypacket&module=admin&op=edit&pid=$packetdata['packetid']{if $_G['uid'] == $packetdata['originatorid']}&pspecial=3{/if}'"><strong>{lang luckypacket:edit_packet}</strong></button></p><!--{/if}-->
					<!--{if $packetAdmin}-->
						<!--{if $packetdata['pspecial'] == PACKET_TYPE_PERSON && $packetdata['ispass'] != 1}--><p class="mbn"><span id="moderate$packetdata['packetid']"><button style="clear:both;" class="pn" type="button" onclick="checkval($packetdata['packetid'], 'plugin.php?id=luckypacket&module=ajax&inajax=1&action=moderate&pid=$packetdata['packetid']', 'moderate');"><strong>{lang luckypacket:moderate_pass}</strong></button></p><!--{/if}-->
						<!--{if $packetdata['status'] != PACKEY_STATUS_DELETE}--><p class="mbn"><span id="del$packetdata['packetid']"><button style="clear:both;" class="pn" type="button" onclick="delconfirm($packetdata['packetid'], 'plugin.php?id=luckypacket&module=ajax&inajax=1&action=del&pid=$packetdata['packetid']', 'del');"><strong>{lang luckypacket:moderate_del}</strong></button></span></p><!--{/if}-->
						<!--<p class="mbn"><span id="reset$packetdata['packetid']"><button style="clear:both;" class="pn" type="button" onclick="resetconfirm($packetdata['packetid'], 'plugin.php?id=luckypacket&module=ajax&inajax=1&action=reset&pid=$packetdata['packetid']', 'reset');"><strong>{lang luckypacket:moderate_reset}</strong></button></span></p>-->
					<!--{/if}-->
					</td>
				</tr>
				<!--{/loop}-->
				</form>
				<tr><td class="ptm" colspan="3">$multipage</td></tr>
			<!--{/if}-->
			</table>
		<!--{/if}-->
			</div>
		</div>
	</div>
</div>
<script type="text/javascript" reload="1">
function delconfirm(pid, href, mod) {
	if(confirm('{lang luckypacket:confirm_msg}')) {
		checkval(pid, href, mod);
	}
}

function resetconfirm(pid, href, mod) {
	if(confirm('{lang luckypacket:confirm_msg}')) {
		checkval(pid, href, mod);
	}
}

function checkval(pid, link, moderate) {
	ajaxresponse(pid, link, moderate);
}

function ajaxresponse(pid, data, mod) {
	var x = new Ajax('XML', mod+pid);
	x.get(data, function(s){
		var obj = $(mod+pid);
		s = trim(s);
		if(s.indexOf('bad_mod') < 0) {
			if(s.indexOf('$moderate_pass') > -1) {
				obj.style.display = '';
				obj.innerHTML = '&nbsp;<img src="{STATICURL}image/common/check_right.gif" width="16" height="16" />&nbsp;' + s;
				obj.className = "warning";
				$('no_pass' + pid).innerHTML = '';
				$('trbg' + pid).style.background="#fff";
			}
			if(s.indexOf('$del_succeed') > -1) {
				obj.style.display = '';
				obj.innerHTML = '&nbsp;<img src="{STATICURL}image/common/check_right.gif" width="16" height="16" />&nbsp;' + s;
				obj.className = "warning";
			}
		} else {
			warning(obj, '$bad_mod');
		}
	});
}

function warning(obj, msg) {
	obj.style.display = '';
	obj.innerHTML = '&nbsp;<img src="{STATICURL}image/common/check_error.gif" width="16" height="16" alt="error_tip" />&nbsp;' + msg;
	obj.className = "warning";
}

</script>